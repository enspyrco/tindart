default_platform(:ios)

# ==================== Android ====================
platform :android do
  desc "Upload screenshots to Google Play Store"
  lane :upload_screenshots do
    upload_to_play_store(
      package_name: "co.enspyr.tindart",
      json_key_data: ENV["PLAY_STORE_JSON_KEY"],
      skip_upload_apk: true,
      skip_upload_aab: true,
      skip_upload_metadata: false,
      skip_upload_changelogs: true,
      skip_upload_images: false,
      skip_upload_screenshots: false
    )
  end

  desc "Upload metadata only (description, title, etc.)"
  lane :upload_metadata do
    upload_to_play_store(
      package_name: "co.enspyr.tindart",
      json_key_data: ENV["PLAY_STORE_JSON_KEY"],
      skip_upload_apk: true,
      skip_upload_aab: true,
      skip_upload_metadata: false,
      skip_upload_changelogs: false,
      skip_upload_images: true,
      skip_upload_screenshots: true
    )
  end
end

# ==================== iOS ====================

api_key = app_store_connect_api_key(
  key_id: ENV["ASC_KEY_ID"],
  issuer_id: ENV["ASC_ISSUER_ID"],
  key_content: ENV["ASC_PRIVATE_KEY"],
  is_key_content_base64: false
)

platform :ios do
  desc "Upload screenshots to App Store Connect"
  lane :upload_screenshots do
    deliver(
      api_key: api_key,
      skip_binary_upload: true,
      skip_metadata: true,
      skip_app_version_update: true,
      overwrite_screenshots: true,
      precheck_include_in_app_purchases: false
    )
  end

  desc "Upload metadata only (description, title, etc.)"
  lane :upload_metadata do
    deliver(
      api_key: api_key,
      skip_binary_upload: true,
      skip_screenshots: true,
      skip_app_version_update: true,
      precheck_include_in_app_purchases: false
    )
  end
end
